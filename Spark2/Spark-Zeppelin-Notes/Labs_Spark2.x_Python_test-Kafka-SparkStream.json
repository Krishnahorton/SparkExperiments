{"paragraphs":[{"text":"%spark2.dep\nz.reset()\nz.load(\"org.apache.spark:spark-streaming-kafka-0-8_2.11:2.3.1\")\n","user":"admin","dateUpdated":"2018-09-28T07:41:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Must be used before SparkInterpreter (%spark) initialized\nHint: put this paragraph before any Spark code and restart Zeppelin/Interpreter"}]},"apps":[],"jobName":"paragraph_1538118785522_-1004717237","id":"20180928-071305_750869571","dateCreated":"2018-09-28T07:13:05+0000","dateStarted":"2018-09-28T07:41:19+0000","dateFinished":"2018-09-28T07:41:48+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:34900"},{"title":"Initialise StreamingContext","text":"%spark2.pyspark\nfrom pyspark.streaming.kafka import KafkaUtils\nfrom pyspark.streaming import StreamingContext\nssc = StreamingContext(sc,1)\n\n","user":"admin","dateUpdated":"2018-09-28T07:41:19+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","colWidth":12,"editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538118242826_928570715","id":"20160331-233830_541232082","dateCreated":"2018-09-28T07:04:02+0000","dateStarted":"2018-09-28T07:41:25+0000","dateFinished":"2018-09-28T07:41:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34901"},{"title":"Create kafka direct stream","text":"%spark2.pyspark\ntopic = \"test100\"\nbrokers = \"c120-node3.squadron-labs.com:6667\"\nkafkaStream = KafkaUtils.createDirectStream(ssc, [topic], {\"metadata.broker.list\": brokers})","user":"admin","dateUpdated":"2018-09-28T07:41:24+0000","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","colWidth":12,"title":true,"results":[],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538118242828_926262222","id":"20160331-233830_2015200328","dateCreated":"2018-09-28T07:04:02+0000","dateStarted":"2018-09-28T07:41:25+0000","dateFinished":"2018-09-28T07:41:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34902"},{"title":"Find frequency of words","text":"%spark2.pyspark\nlines = kafkaStream.map(lambda x: x[1])\ncounts = lines.flatMap(lambda line: line.split(\" \")).map(lambda word: (word, 1)).reduceByKey(lambda a, b: a+b)\ncounts.pprint()","user":"admin","dateUpdated":"2018-09-28T07:41:24+0000","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","colWidth":12,"editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1538118242829_925877473","id":"20160331-233830_1740542201","dateCreated":"2018-09-28T07:04:02+0000","dateStarted":"2018-09-28T07:41:48+0000","dateFinished":"2018-09-28T07:41:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:34903"},{"title":"Strart Streaming","text":"%spark2.pyspark\nssc.start()\nssc.awaitTermination()","user":"admin","dateUpdated":"2018-09-28T07:41:24+0000","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","colWidth":12,"editorHide":true,"title":true,"results":[],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538118242829_925877473","id":"20160331-233830_270532773","dateCreated":"2018-09-28T07:04:02+0000","dateStarted":"2018-09-28T07:41:49+0000","dateFinished":"2018-09-28T07:42:33+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:34904","errorMessage":""},{"text":"","user":"admin","dateUpdated":"2018-09-28T07:38:37+0000","config":{"editorSetting":{"editOnDblClick":false,"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538118242844_932418204","id":"20161018-144007_1720066531","dateCreated":"2018-09-28T07:04:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:34905"}],"name":"Labs / Spark 2.x / Data Worker / Python / test-Kafka-SparkStream","id":"2DQW9NFKW","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}